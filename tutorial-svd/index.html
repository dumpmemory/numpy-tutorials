<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Linear algebra on n-dimensional arrays - Numpy Tutorials</title><meta property="og:title" content="Linear algebra on n-dimensional arrays - Numpy Tutorials"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/numpy-tutorials/build/b77199e99a54e59b2e3c037c2cc90f21.svg"/><meta property="og:image" content="/numpy-tutorials/build/b77199e99a54e59b2e3c037c2cc90f21.svg"/><link rel="stylesheet" href="/numpy-tutorials/build/_assets/app-IZWEOBHI.css"/><link rel="stylesheet" href="/numpy-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/numpy-tutorials/favicon.ico"/><link rel="stylesheet" href="/numpy-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/numpy-tutorials/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/numpy-tutorials/build/numpylogo-23de9fdb80573cc5ba632ea3967e876d.svg" class="h-9" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Numpy Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/numpy-tutorials/">Numpy Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Applications" class="block break-words rounded py-2 grow cursor-pointer">Applications</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Features" class="block break-words rounded py-2 grow cursor-pointer">Features</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Contributing" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/numpy-tutorials/contributing">Contributing</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/numpy/numpy-tutorials" title="GitHub Repository: numpy/numpy-tutorials" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><a href="https://github.com/numpy/numpy-tutorials/edit/main/content/tutorial-svd.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Linear algebra on n-dimensional arrays</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">Numpy Community</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><h2 id="prerequisites" class="relative group"><span class="heading-text">Prerequisites</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prerequisites" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Before reading this tutorial, you should know a bit of Python. If you would like to refresh your memory, take a look at the <a target="_blank" rel="noreferrer" href="https://docs.python.org/3/tutorial/" class="">Python tutorial</a>.</p><p>If you want to be able to run the examples in this tutorial, you should also have <a target="_blank" rel="noreferrer" href="https://matplotlib.org/" class="">matplotlib</a> and <a target="_blank" rel="noreferrer" href="https://scipy.org" class="">SciPy</a> installed on your computer.</p><h2 id="learner-profile" class="relative group"><span class="heading-text">Learner profile</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learner-profile" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This tutorial is for people who have a basic understanding of linear algebra and arrays in NumPy and want to understand how n-dimensional (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n&gt;=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span>) arrays are represented and can be manipulated. In particular, if you don’t know how to apply common functions to n-dimensional arrays (without using for-loops), or if you want to understand axis and shape properties for n-dimensional arrays, this tutorial might be of help.</p><h2 id="learning-objectives" class="relative group"><span class="heading-text">Learning Objectives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-objectives" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>After this tutorial, you should be able to:</p><ul><li><p>Understand the difference between one-, two- and n-dimensional arrays in NumPy;</p></li><li><p>Understand how to apply some linear algebra operations to n-dimensional arrays without using for-loops;</p></li><li><p>Understand axis and shape properties for n-dimensional arrays.</p></li></ul><h2 id="content" class="relative group"><span class="heading-text">Content</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#content" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this tutorial, we will use a <a href="https://en.wikipedia.org/wiki/Matrix_decomposition" class="italic" target="_blank" rel="noreferrer" data-state="closed">matrix decomposition</a> from linear algebra, the Singular Value Decomposition, to generate a compressed approximation of an image. We’ll use the <code>face</code> image from the <a target="_blank" rel="noreferrer" href="https://docs.scipy.org/doc/scipy/reference/datasets.html" class="">scipy.datasets</a> module:</p><div id="lutqCw6GJR" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from scipy.datasets import face

img = face()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="x6JH7XLbdtKAAIxolIeqQ" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Downloading file &#x27;face.dat&#x27; from &#x27;https://raw.githubusercontent.com/scipy/dataset-face/main/face.dat&#x27; to &#x27;/home/runner/.cache/scipy-data&#x27;.
</span></code></pre></div></div></div><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>If you prefer, you can use your own image as you work through this tutorial.
In order to transform your image into a NumPy array that can be manipulated, you
can use the <code>imread</code> function from the
<a target="_blank" rel="noreferrer" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot" class="">matplotlib.pyplot</a> submodule.
Alternatively, you can use the
<a target="_blank" rel="noreferrer" href="https://imageio.readthedocs.io/en/stable/_autosummary/imageio.v3.imread.html" class="">imageio.imread</a>
function from the <code>imageio</code> library.
Be aware that if you use your own image, you’ll likely need to adapt the steps below.
For more information on how images are treated when converted to NumPy arrays,
see <a target="_blank" rel="noreferrer" href="https://scikit-image.org/docs/stable/user_guide/numpy_images.html" class="">A crash course on NumPy for images</a> from the <code>scikit-image</code> documentation.</p></div></aside><p>Now, <code>img</code> is a NumPy array, as we can see when using the <code>type</code> function:</p><div id="vFEHY4adLD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">type(img)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Sx8_n_WGoxnQ9Z8cW3Qkq" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>numpy.ndarray</span></code></div></div></div><p>We can see the image using the <a target="_blank" rel="noreferrer" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" class="">matplotlib<wbr/>.pyplot<wbr/>.imshow</a> function &amp; the special iPython command, <code>%matplotlib inline</code> to display plots inline:</p><div id="LYDuvDWJDh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt

%matplotlib inline</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="k5MoiHHFAld3lJeB-4sP5" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><div id="iSEB2u9JG6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.imshow(img)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="80GOrdCSbxpX2HxdClxO3" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><img src="/numpy-tutorials/build/35ed8e4357022ff8e82394d52fe8f523.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><h3 id="shape-axis-and-array-properties" class="relative group"><span class="heading-text">Shape, axis and array properties</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#shape-axis-and-array-properties" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Note that, in linear algebra, the dimension of a vector refers to the number of entries in an array. In NumPy, it instead defines the number of axes. For example, a 1D array is a vector such as <code>[1, 2, 3]</code>, a 2D array is a matrix, and so forth.</p><p>First, let’s check for the shape of the data in our array. Since this image is two-dimensional (the pixels in the image form a rectangle), we might expect a two-dimensional array to represent it (a matrix). However, using the <code>shape</code> property of this NumPy array gives us a different result:</p><div id="RbZG3FaHHv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UwQ9FjvmllX0sUSWsQTkO" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(768, 1024, 3)</span></code></div></div></div><p>The output is a <a target="_blank" rel="noreferrer" href="https://docs.python.org/dev/tutorial/datastructures.html#tut-tuples" class="">tuple</a> with three elements, which means that this is a three-dimensional array. Since this is a color image, and we have used the <code>imread</code> function to read it, the data is organized as a 768×1024 grid of pixels, where each pixel contains 3 values representing color channels (red, green and blue - RGB). You can see this by looking at the shape, where the leftmost number corresponds to the outermost axis (image height), the middle number to the next axis (image width) and the rightmost number to the innermost axis (the color channels).</p><p>Furthermore, using the <code>ndim</code> property of this array, we can see that</p><div id="mQT6bSJz0Q" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img.ndim</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FwdpYkC6vHHMk87QOcNIR" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>3</span></code></div></div></div><p>NumPy refers to each dimension as an <em>axis</em>. Because of how <code>imread</code> works, the <em>first index in the 3rd axis</em> is the red pixel data for our image. We can access this by using the syntax</p><div id="ykZP0P9PI1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img[:, :, 0]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2IPrHiPtWTm3iyxL2il-7" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>array([[121, 138, 153, ..., 119, 131, 139],
       [ 89, 110, 130, ..., 118, 134, 146],
       [ 73,  94, 115, ..., 117, 133, 144],
       ...,
       [ 87,  94, 107, ..., 120, 119, 119],
       [ 85,  95, 112, ..., 121, 120, 120],
       [ 85,  97, 111, ..., 120, 119, 118]],
      shape=(768, 1024), dtype=uint8)</span></code></div></div></div><p>From the output above, we can see that every value in <code>img[:, :, 0]</code> is an integer value between 0 and 255, representing the level of red in each corresponding image pixel (keep in mind that this might be different if you
use your own image instead of <a target="_blank" rel="noreferrer" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.datasets.face.html" class="">scipy.datasets.face</a>).</p><p>As expected, this is a 768x1024 matrix:</p><div id="gQqWll31oj" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img[:, :, 0].shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hCiBu4zrv9C_Vmb-Wgwc7" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(768, 1024)</span></code></div></div></div><p>Since we are going to perform linear algebra operations on this data, it might be more interesting to have real numbers between 0 and 1 in each entry of the matrices to represent the RGB values. We can do that by setting</p><div id="TM2k28VAVc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img_array = img / 255</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AQWUWSa7xmKNRt9BwRrgz" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>This operation, dividing an array by a scalar, works because of NumPy’s <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/user/theory.broadcasting.html#array-broadcasting-in-numpy" class="">broadcasting rules</a>.</p><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Tip</div></div><div class="myst-admonition-body px-4 py-1"><p>In real-world applications, it may be better to use, for example, the
<a target="_blank" rel="noreferrer" href="https://scikit-image.org/docs/stable/api/skimage.html#skimage.img_as_float" class="">img_as_float</a>
utility function from <code>scikit-image</code>.</p></div></aside><p>You can check that the above works by doing some tests; for example, inquiring
about maximum and minimum values for this array:</p><div id="NHXQl0z4vE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img_array.min(), img_array.max()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YG_YFVrZHMwQ-Oy_x8inU" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(np.float64(0.0), np.float64(1.0))</span></code></div></div></div><p>or checking the type of data in the array:</p><div id="GLtlTln5Qc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img_array.dtype</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xKkCpNS3slX12KHBbtFfZ" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>dtype(&#x27;float64&#x27;)</span></code></div></div></div><p>Note that we can assign each color channel to a separate matrix using the slice syntax:</p><div id="LRWDiosjzw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">red_array = img_array[:, :, 0]
green_array = img_array[:, :, 1]
blue_array = img_array[:, :, 2]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CBOTGZWWO_wqD3RY6KHHg" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><h3 id="operations-on-an-axis" class="relative group"><span class="heading-text">Operations on an axis</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#operations-on-an-axis" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>It is possible to use methods from linear algebra to approximate an existing set of data. Here, we will use the <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition" class="italic" target="_blank" rel="noreferrer" data-state="closed">SVD (Singular Value Decomposition)</a> to try to rebuild an image that uses less singular value information than the original one, while still retaining some of its features.</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>We will use NumPy’s linear algebra module,
<a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/routines.linalg.html#module-numpy.linalg" class="">numpy.linalg</a>,
to perform the operations in this tutorial.
Most of the linear algebra functions in this module can also be found in
<a target="_blank" rel="noreferrer" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" class="">scipy.linalg</a>,
and users are encouraged to use the <a target="_blank" rel="noreferrer" href="https://docs.scipy.org/doc/scipy/reference/index.html#module-scipy" class="">scipy</a>
module for real-world applications.
However, some functions in the
<a target="_blank" rel="noreferrer" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" class="">scipy.linalg</a>
module, such as the SVD function, only support 2D arrays.
For more information on this, check the <a target="_blank" rel="noreferrer" href="https://docs.scipy.org/doc/scipy/tutorial/linalg.html" class="">scipy.linalg page</a>.</p></div></aside><p>In order to extract information from a given matrix, we can use the SVD to obtain 3 arrays which can be multiplied to obtain the original matrix. From the theory of linear algebra, given a matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>, the following product can be computed:</p><div id="CASFHsxNGU" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>U</mi><mi mathvariant="normal">Σ</mi><msup><mi>V</mi><mi>T</mi></msup><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">U \Sigma V^T = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord">Σ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#CASFHsxNGU" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>where <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">V^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span> are square and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></span> is the same size as <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>. <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></span> is a diagonal matrix and contains the <a href="https://en.wikipedia.org/wiki/Singular_value" class="italic" target="_blank" rel="noreferrer" data-state="closed">singular values</a> of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>, organized from largest to smallest. These values are always non-negative and can be used as an indicator of the “importance” of some features represented by the matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>.</p><p>Let’s see how this works in practice with just one matrix first. Note that according to <a href="https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale" class="italic" target="_blank" rel="noreferrer" data-state="closed">colorimetry</a>,
it is possible to obtain a fairly reasonable grayscale version of our color image if we apply the formula</p><div id="l2YsCulrVG" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo>=</mo><mn>0.2126</mn><mi>R</mi><mo>+</mo><mn>0.7152</mn><mi>G</mi><mo>+</mo><mn>0.0722</mn><mi>B</mi></mrow><annotation encoding="application/x-tex">Y = 0.2126 R + 0.7152 G + 0.0722 B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">0.2126</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">0.7152</span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0.0722</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#l2YsCulrVG" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>where <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span> is the array representing the grayscale image, and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span> are the red, green and blue channel arrays we had originally. Notice we can use the <code>@</code> operator (the matrix multiplication operator for NumPy arrays, see <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul" class="">numpy.matmul</a>) for this:</p><div id="xGQ158f3kB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img_gray = img_array @ [0.2126, 0.7152, 0.0722]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Tpp3gC7Q6HYm14nQl2p7B" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>Now, <code>img_gray</code> has shape</p><div id="pxANcckHig" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img_gray.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Q8BeIO53hZc9HI2SURYQc" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(768, 1024)</span></code></div></div></div><p>To see if this makes sense in our image, we should use a colormap from <code>matplotlib</code> corresponding to the color we wish to see in out image (otherwise, <code>matplotlib</code> will default to a colormap that does not correspond to the real data).</p><p>In our case, we are approximating the grayscale portion of the image, so we will use the colormap <code>gray</code>:</p><div id="beCpRLI0Eb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.imshow(img_gray, cmap=&quot;gray&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="So5aCgiJ4fYOcCKcCdogK" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><img src="/numpy-tutorials/build/bb7f8d356776563e0184fede5531d1c4.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><p>Now, applying the <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.linalg.svd.html#numpy.linalg.svd" class="">linalg.svd</a> function to this matrix, we obtain the following decomposition:</p><div id="QzmHy4v9rT" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
U, s, Vt = np.linalg.svd(img_gray)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6gXEYnmKkzhsSrg8YxhKo" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>If you are using your own image, this command might take a while to run,
depending on the size of your image and your hardware.
Don’t worry, this is normal! The SVD can be a pretty intensive computation.</p></div></aside><p>Let’s check that this is what we expected:</p><div id="fHnLt5t4vb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">U.shape, s.shape, Vt.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="slkSbue1WMCLvnk6_Bxwc" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>((768, 768), (768,), (1024, 1024))</span></code></div></div></div><p>Note that <code>s</code> has a particular shape: it has only one dimension. This means that some linear algebra functions that expect 2d arrays might not work. For example, from the theory, one might expect <code>s</code> and <code>Vt</code> to be
compatible for multiplication. However, this is not true as <code>s</code> does not have a second axis:</p><div id="rb2dMnhgI8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">s @ Vt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OG5igOswuQMYKmnHndGkr" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>                                Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[18]</span><span style="color:rgb(0, 187, 0)">, line 1</span><span>
</span><span style="color:rgb(0, 187, 0)">----&gt; </span><span style="color:rgb(0, 187, 0)">1</span><span> </span><span style="background-color:rgb(187, 187, 0)">s</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">@</span><span style="background-color:rgb(187, 187, 0)"> </span><span style="background-color:rgb(187, 187, 0)">Vt</span><span>

</span><span style="color:rgb(187, 0, 0)">ValueError</span><span>: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)-&gt;(n?,m?) (size 1024 is different from 768)</span></code></pre></div></div></div><p>results in a <code>ValueError</code>. This happens because having a one-dimensional array for <code>s</code>, in this case, is much more economic in practice than building a diagonal matrix with the same data. To reconstruct the original matrix, we can rebuild the diagonal matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></span> with the elements of <code>s</code> in its diagonal and with the appropriate dimensions for multiplying: in our case, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span></span> should be 768x1024 since <code>U</code> is 768x768 and <code>Vt</code> is 1024x1024. In order to add the singular values to the diagonal of <code>Sigma</code>, we will use the <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.fill_diagonal.html" class="">fill_diagonal</a> function from NumPy:</p><div id="vnvkWMeeMW" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">Sigma = np.zeros((U.shape[1], Vt.shape[0]))
np.fill_diagonal(Sigma, s)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SxNsmNCjByReHPbFnO6r6" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>Now, we want to check if the reconstructed <code>U @ Sigma @ Vt</code> is close to the original <code>img_gray</code> matrix.</p><h2 id="approximation" class="relative group"><span class="heading-text">Approximation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#approximation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/routines.linalg.html#module-numpy.linalg" class="">linalg</a> module includes a <code>norm</code> function, which computes the norm of a vector or matrix represented in a NumPy array. For example, from the SVD explanation above, we would expect the norm of the difference between <code>img_gray</code> and the reconstructed SVD product to be small. As expected, you should see something like</p><div id="r861AtP0Ls" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">np.linalg.norm(img_gray - U @ Sigma @ Vt)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZYB6RDgpfJPCWHDiFoITR" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>np.float64(1.4314854759568272e-12)</span></code></div></div></div><p>(The actual result of this operation might be different depending on your architecture and linear algebra setup. Regardless, you should see a small number.)</p><p>We could also have used the <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.allclose.html#numpy.allclose" class="">numpy.allclose</a> function to make sure the reconstructed product is, in fact, <em>close</em> to our original matrix (the difference between the two arrays is small):</p><div id="gKxejRGXZr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">np.allclose(img_gray, U @ Sigma @ Vt)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_Ko10rKrhIpBYYNUsn4Wd" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>True</span></code></div></div></div><p>To see if an approximation is reasonable, we can check the values in <code>s</code>:</p><div id="BRwMyiDMln" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.plot(s)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OgXITMhxiTjfsi1o9OiGV" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><img src="/numpy-tutorials/build/2ff5865e000b94880260d6057f07561c.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><p>In the graph, we can see that although we have 768 singular values in <code>s</code>, most of those (after the 150th entry or so) are pretty small. So it might make sense to use only the information related to the first (say, 50) <em>singular values</em> to build a more economical approximation to our image.</p><p>The idea is to consider all but the first <code>k</code> singular values in <code>Sigma</code> (which are the same as in <code>s</code>) as zeros, keeping <code>U</code> and <code>Vt</code> intact, and computing the product of these matrices as the approximation.</p><p>For example, if we choose</p><div id="MHbSMQDxyS" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">k = 10</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VfmwTwd6ibWx4Zei_em5j" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>we can build the approximation by doing</p><div id="qwopRmfxs0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">approx = U @ Sigma[:, :k] @ Vt[:k, :]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AkkRdE5Vf1CajLlxNQOEd" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>Note that we had to use only the first <code>k</code> rows of <code>Vt</code>, since all other rows would be multiplied by the zeros corresponding to the singular values we eliminated from this approximation.</p><div id="frnHS03PoM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.imshow(approx, cmap=&quot;gray&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="24ujeX-mHFp47uHQPeRqM" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><img src="/numpy-tutorials/build/8518b580a53672f5f630f659c4699def.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><p>Now, you can go ahead and repeat this experiment with other values of <code>k</code>, and each of your experiments should give you a slightly better (or worse) image depending on the value you choose.</p><h3 id="applying-to-all-colors" class="relative group"><span class="heading-text">Applying to all colors</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#applying-to-all-colors" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we want to do the same kind of operation, but to all three colors. Our first instinct might be to repeat the same operation we did above to each color matrix individually. However, NumPy’s <em>broadcasting</em> takes care of this
for us.</p><p>If our array has more than two dimensions, then the SVD can be applied to all axes at once. However, the linear algebra functions in NumPy expect to see an array of the form <code>(n, M, N)</code>, where the first axis <code>n</code> represents the number of <code>MxN</code> matrices in the stack.</p><p>In our case,</p><div id="A87NTBr2PC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">img_array.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_acaPrD5_zAjWJrAkq7qD" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(768, 1024, 3)</span></code></div></div></div><p>so we need to permutate the axis on this array to get a shape like <code>(3, 768, 1024)</code>. Fortunately, the <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.transpose.html#numpy.transpose" class="">numpy.transpose</a> function can do that for us:</p><div id="Hhcrhgk7wB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># The values in the tuple indicate the original dim, and the order the new axis
# so axis 2 -&gt; 0, 0 -&gt; 1, and 1 -&gt; 2
img_array_transposed = np.transpose(img_array, (2, 0, 1))
img_array_transposed.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9YL2iIqkiKPx1P0U-NUno" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(3, 768, 1024)</span></code></div></div></div><p>Now we are ready to apply the SVD:</p><div id="KNNcSSV48M" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">U, s, Vt = np.linalg.svd(img_array_transposed)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8GGIAcBDkrpR7-D8X35zj" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>Finally, to obtain the full approximated image, we need to reassemble these matrices into the approximation. Now, note that</p><div id="vcIA7IryGc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">U.shape, s.shape, Vt.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="36l7JnPjWrG7m8nwuxmJq" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>((3, 768, 768), (3, 768), (3, 1024, 1024))</span></code></div></div></div><p>To build the final approximation matrix, we must understand how multiplication across different axes works.</p><h3 id="products-with-n-dimensional-arrays" class="relative group"><span class="heading-text">Products with n-dimensional arrays</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#products-with-n-dimensional-arrays" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>If you have worked before with only one- or two-dimensional arrays in NumPy, you might use <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.dot.html#numpy.dot" class="">numpy.dot</a> and <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul" class="">numpy.matmul</a> (or the <code>@</code> operator) interchangeably. However, for n-dimensional arrays, they work in very different ways. For more details, check the documentation on <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul" class="">numpy.matmul</a>.</p><p>Now, to build our approximation, we first need to make sure that our singular values are ready for multiplication, so we build our <code>Sigma</code> matrix similarly to what we did before. The <code>Sigma</code> array must have dimensions <code>(3, 768, 1024)</code>. In order to add the singular values to the diagonal of <code>Sigma</code>, we will again use the <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/generated/numpy.fill_diagonal.html" class="">fill_diagonal</a> function, using each of the 3 rows in <code>s</code> as the diagonal for each of the 3 matrices in <code>Sigma</code>:</p><div id="VgUBCcOaw0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">Sigma = np.zeros((3, 768, 1024))
for j in range(3):
    np.fill_diagonal(Sigma[j, :, :], s[j, :])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DyMFT57MTXGgnvV5OO3WC" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>Now, if we wish to rebuild the full SVD (with no approximation), we can do</p><div id="gSMAbceKdO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">reconstructed = U @ Sigma @ Vt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LWPPtMb_yIjEMofeKvk8O" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>Note that</p><div id="ce8q262xev" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">reconstructed.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Tsgas1v5yECnRBknZQyZe" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(3, 768, 1024)</span></code></div></div></div><p>The reconstructed image should be indistinguishable from the original one, except for differences due to floating point errors from the reconstruction. Recall that our original image consisted of floating point values in the range <code>[0., 1.]</code>. The accumulation of floating point error from the reconstruction can result in values slightly outside this original range:</p><div id="Hnjk4ENMnK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">reconstructed.min(), reconstructed.max()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dmSXl7BrwpYgA6cSGbF1x" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(np.float64(-5.0176876542629145e-15), np.float64(1.0000000000000049))</span></code></div></div></div><p>Since <code>imshow</code> expects values in the range, we can use <code>clip</code> to excise the floating point error:</p><div id="puW5jTimZK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">reconstructed = np.clip(reconstructed, 0, 1)
plt.imshow(np.transpose(reconstructed, (1, 2, 0)))
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="S_6wt6YWNLkmFKUUOvOlb" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><img src="/numpy-tutorials/build/3d50d6f8f5ee12a8f873781f2a366fb5.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>In fact, <code>imshow</code> peforms this clipping under-the-hood, so if you skip the first
line in the previous code cell, you might see a warning message saying
<code>&quot;Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).&quot;</code></p></div></aside><p>Now, to do the approximation, we must choose only the first <code>k</code> singular values for each color channel. This can be done using the following syntax:</p><div id="XEzPXujL3N" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">approx_img = U @ Sigma[..., :k] @ Vt[..., :k, :]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Xb1vcESfBHEWWTQ8LOxWH" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left"></div></div><p>You can see that we have selected only the first <code>k</code> components of the last axis for <code>Sigma</code> (this means that we have used only the first <code>k</code> columns of each of the three matrices in the stack), and that we have selected only the first <code>k</code> components in the second-to-last axis of <code>Vt</code> (this means we have selected only the first <code>k</code> rows from every matrix in the stack <code>Vt</code> and all columns). If you are unfamiliar with the ellipsis syntax, it is a
placeholder for other axes. For more details, see the documentation on <a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/user/basics.indexing.html#basics-indexing" class="">Indexing</a>.</p><p>Now,</p><div id="P9cWWJVvAr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">approx_img.shape</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tYFf4JpOebvuwprMr6tDD" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(3, 768, 1024)</span></code></div></div></div><p>which is not the right shape for showing the image. Finally, reordering the axes back to our original shape of <code>(768, 1024, 3)</code>, we can see our approximation:</p><div id="kHg2G6Tmk3" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.imshow(np.transpose(np.clip(approx_img, 0, 1), (1, 2, 0)))
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="r1ULw-5kCbVI-4WlJYtMm" class="max-w-full overflow-x-auto m-0 group not-prose relative overflow-y-visible text-left mb-5"><img src="/numpy-tutorials/build/e2fc93d528ff090a57b885dd9c221f93.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><p>Even though the image is not as sharp, using a small number of <code>k</code> singular values (compared to the original set of 768 values), we can recover many of the distinguishing features from this image.</p><h3 id="final-words" class="relative group"><span class="heading-text">Final words</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#final-words" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Of course, this is not the best method to <em>approximate</em> an image. However, there is, in fact, a result in linear algebra that says that the approximation we built above is the best we can get to the original matrix in
terms of the norm of the difference. For more information, see <em>G. H. Golub and C. F. Van Loan, Matrix Computations, Baltimore, MD, Johns Hopkins University Press, 1985</em>.</p><h2 id="further-reading" class="relative group"><span class="heading-text">Further reading</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#further-reading" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p><a target="_blank" rel="noreferrer" href="https://docs.python.org/dev/tutorial/index.html" class="">Python tutorial</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://numpy.org/devdocs/reference/index.html#reference" class="">NumPy Reference</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://docs.scipy.org/doc/scipy/tutorial/index.html" class="">SciPy Tutorial</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://scipy-lectures.org" class="">SciPy Lecture Notes</a></p></li><li><p><a target="_blank" rel="noreferrer" href="http://mathesaurus.sf.net/" class="">A matlab, R, IDL, NumPy/SciPy dictionary</a></p></li></ul><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/numpy-tutorials/tutorial-air-quality-analysis"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Applications</div>Analyzing the impact of the lockdown on air quality in Delhi, India</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/numpy-tutorials/save-load-arrays"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Features</div>Saving and sharing your NumPy arrays</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/numpy-tutorials/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-F7G67JTZ.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/numpy-tutorials/build/root-7TUVC4ZT.js"/><link rel="modulepreload" href="/numpy-tutorials/build/_shared/chunk-INOWNUZ6.js"/><link rel="modulepreload" href="/numpy-tutorials/build/routes/$-P6PGXPYX.js"/><script>window.__remixContext = {"url":"/tutorial-svd","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"favicon":"/numpy-tutorials/build/favicon-35282b3e12bf2b19c595faa9de1f2f9b.png","logo":"/numpy-tutorials/build/numpylogo-23de9fdb80573cc5ba632ea3967e876d.svg"},"nav":[],"actions":[],"projects":[{"title":"Numpy Tutorials","authors":[{"id":"Numpy Community","name":"Numpy Community"}],"github":"https://github.com/numpy/numpy-tutorials","toc":[{"file":"site/index.md"},{"children":[{"file":"content/mooreslaw-tutorial.md"},{"file":"content/tutorial-deep-learning-on-mnist.md"},{"file":"content/tutorial-x-ray-image-processing.md"},{"file":"content/tutorial-static_equilibrium.md"},{"file":"content/tutorial-plotting-fractals.md"},{"file":"content/tutorial-air-quality-analysis.md"}],"title":"Applications"},{"children":[{"file":"content/tutorial-svd.md"},{"file":"content/save-load-arrays.md"},{"file":"content/tutorial-ma.md"}],"title":"Features"},{"children":[{"file":"content/tutorial-style-guide.md"}],"file":"site/contributing.md","title":"Contributing"}],"thumbnail":"/numpy-tutorials/build/b77199e99a54e59b2e3c037c2cc90f21.svg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Applications"},{"slug":"mooreslaw-tutorial","title":"Determining Moore’s Law with real data in NumPy","description":"","date":"","thumbnail":"/numpy-tutorials/build/01-mooreslaw-tutoria-9bfda9e6dca3effd65700df595b785c5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-deep-learning-on-mnist","title":"Deep learning on MNIST","description":"","date":"","thumbnail":"/numpy-tutorials/build/tutorial-deep-learni-afc13531aca16179e3652bf460cb0f94.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-x-ray-image-processing","title":"X-ray image processing","description":"","date":"","thumbnail":"/numpy-tutorials/build/tutorial-x-ray-image-9dac6a71ace45b637ba56b7686ee7b7b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-static-equilibrium","title":"Determining Static Equilibrium in NumPy","description":"","date":"","thumbnail":"/numpy-tutorials/build/static_eqbm-fig01-03b7d98bea6ff02c849affb0ef937eb9.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-plotting-fractals","title":"Plotting Fractals","description":"","date":"","thumbnail":"/numpy-tutorials/build/fractal-4bfe938619caff2d85fe8e7e8c96174b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-air-quality-analysis","title":"Analyzing the impact of the lockdown on air quality in Delhi, India","description":"","date":"","thumbnail":"/numpy-tutorials/build/11-delhi-aqi-2107c47621d490d75baf4bee4a76bbb6.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Features"},{"slug":"tutorial-svd","title":"Linear algebra on n-dimensional arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"save-load-arrays","title":"Saving and sharing your NumPy arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-ma","title":"Masked Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing","title":"Contributing","description":"","date":"","thumbnail":"/numpy-tutorials/build/01-fork-b2fc3c9415f52b70becf7754010721d9.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tutorial-style-guide","title":"Learn to write a NumPy tutorial","description":"","date":"","thumbnail":"/numpy-tutorials/build/56554e3d11983df8f484e8d7b2c2bdae.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/numpy-tutorials"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"favicon":"/numpy-tutorials/build/favicon-35282b3e12bf2b19c595faa9de1f2f9b.png","logo":"/numpy-tutorials/build/numpylogo-23de9fdb80573cc5ba632ea3967e876d.svg"},"nav":[],"actions":[],"projects":[{"title":"Numpy Tutorials","authors":[{"id":"Numpy Community","name":"Numpy Community"}],"github":"https://github.com/numpy/numpy-tutorials","toc":[{"file":"site/index.md"},{"children":[{"file":"content/mooreslaw-tutorial.md"},{"file":"content/tutorial-deep-learning-on-mnist.md"},{"file":"content/tutorial-x-ray-image-processing.md"},{"file":"content/tutorial-static_equilibrium.md"},{"file":"content/tutorial-plotting-fractals.md"},{"file":"content/tutorial-air-quality-analysis.md"}],"title":"Applications"},{"children":[{"file":"content/tutorial-svd.md"},{"file":"content/save-load-arrays.md"},{"file":"content/tutorial-ma.md"}],"title":"Features"},{"children":[{"file":"content/tutorial-style-guide.md"}],"file":"site/contributing.md","title":"Contributing"}],"thumbnail":"/numpy-tutorials/build/b77199e99a54e59b2e3c037c2cc90f21.svg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Applications"},{"slug":"mooreslaw-tutorial","title":"Determining Moore’s Law with real data in NumPy","description":"","date":"","thumbnail":"/numpy-tutorials/build/01-mooreslaw-tutoria-9bfda9e6dca3effd65700df595b785c5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-deep-learning-on-mnist","title":"Deep learning on MNIST","description":"","date":"","thumbnail":"/numpy-tutorials/build/tutorial-deep-learni-afc13531aca16179e3652bf460cb0f94.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-x-ray-image-processing","title":"X-ray image processing","description":"","date":"","thumbnail":"/numpy-tutorials/build/tutorial-x-ray-image-9dac6a71ace45b637ba56b7686ee7b7b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-static-equilibrium","title":"Determining Static Equilibrium in NumPy","description":"","date":"","thumbnail":"/numpy-tutorials/build/static_eqbm-fig01-03b7d98bea6ff02c849affb0ef937eb9.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-plotting-fractals","title":"Plotting Fractals","description":"","date":"","thumbnail":"/numpy-tutorials/build/fractal-4bfe938619caff2d85fe8e7e8c96174b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-air-quality-analysis","title":"Analyzing the impact of the lockdown on air quality in Delhi, India","description":"","date":"","thumbnail":"/numpy-tutorials/build/11-delhi-aqi-2107c47621d490d75baf4bee4a76bbb6.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Features"},{"slug":"tutorial-svd","title":"Linear algebra on n-dimensional arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"save-load-arrays","title":"Saving and sharing your NumPy arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-ma","title":"Masked Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing","title":"Contributing","description":"","date":"","thumbnail":"/numpy-tutorials/build/01-fork-b2fc3c9415f52b70becf7754010721d9.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tutorial-style-guide","title":"Learn to write a NumPy tutorial","description":"","date":"","thumbnail":"/numpy-tutorials/build/56554e3d11983df8f484e8d7b2c2bdae.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"27c267b669469f10d7cd58fcfd5d67fbc885200bb2c20c40466daa20ef69170f","slug":"tutorial-svd","location":"/content/tutorial-svd.md","dependencies":[],"frontmatter":{"title":"Linear algebra on n-dimensional arrays","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.11.1"}},"content_includes_title":false,"authors":[{"id":"Numpy Community","name":"Numpy Community"}],"github":"https://github.com/numpy/numpy-tutorials","numbering":{"title":{"offset":1}},"source_url":"https://github.com/numpy/numpy-tutorials/blob/main/content/tutorial-svd.md","edit_url":"https://github.com/numpy/numpy-tutorials/edit/main/content/tutorial-svd.md","exports":[{"format":"md","filename":"tutorial-svd.md","url":"/numpy-tutorials/build/tutorial-svd-277f220836df7462704ae0548a286bcd.md"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"tgRS4UbLIv"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"KcrEnZJ4bI"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Before reading this tutorial, you should know a bit of Python. If you would like to refresh your memory, take a look at the ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZzOQXuyB6J"},{"type":"link","url":"https://docs.python.org/3/tutorial/","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Python tutorial","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"yesCzbhTLm"}],"urlSource":"https://docs.python.org/3/tutorial/","key":"d4aKW8svOk"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"v4HRY5KnUR"}],"key":"asgE0Byiv5"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"If you want to be able to run the examples in this tutorial, you should also have ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Udixjc8Eyx"},{"type":"link","url":"https://matplotlib.org/","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"matplotlib","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Mxdt7AXoQX"}],"urlSource":"https://matplotlib.org/","key":"t6UFHyfNOz"},{"type":"text","value":" and ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"voHuKs0iPo"},{"type":"link","url":"https://scipy.org","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"SciPy","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"mKp8umkzXM"}],"urlSource":"https://scipy.org","key":"rK4TjPfYY4"},{"type":"text","value":" installed on your computer.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"bp5mZL3BnP"}],"key":"uPxthMNcTz"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Learner profile","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"lx72FcVHp2"}],"identifier":"learner-profile","label":"Learner profile","html_id":"learner-profile","implicit":true,"key":"axhGiRdN21"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"This tutorial is for people who have a basic understanding of linear algebra and arrays in NumPy and want to understand how n-dimensional (","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"R7Aclclibn"},{"type":"inlineMath","value":"n\u003e=2","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u0026gt;=2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"xZALW3xdVm"},{"type":"text","value":") arrays are represented and can be manipulated. In particular, if you don’t know how to apply common functions to n-dimensional arrays (without using for-loops), or if you want to understand axis and shape properties for n-dimensional arrays, this tutorial might be of help.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"hB2Er7GCqt"}],"key":"iaPo3q9NK2"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"AF3PYsHn0j"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"BZdvC50u3p"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"After this tutorial, you should be able to:","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"mrr9cAoYDQ"}],"key":"etoWs7siuV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand the difference between one-, two- and n-dimensional arrays in NumPy;","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"FjLHjipik4"}],"key":"L2s7NJ7BCj"}],"key":"hhkfkVfavg"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand how to apply some linear algebra operations to n-dimensional arrays without using for-loops;","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"EhucnDrhlz"}],"key":"tQZomnJP9A"}],"key":"FmsVMzJIzI"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand axis and shape properties for n-dimensional arrays.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"XBesLtwuHZ"}],"key":"SqoDDiO3OZ"}],"key":"YgIs9QnsKj"}],"key":"sQNubUlGOO"},{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Content","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"sBNQSHv7lP"}],"identifier":"content","label":"Content","html_id":"content","implicit":true,"key":"EdUtbTNBSV"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"In this tutorial, we will use a ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"YD1he79RX0"},{"type":"link","url":"https://en.wikipedia.org/wiki/Matrix_decomposition","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"matrix decomposition","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"PlP1CRAHqU"}],"urlSource":"https://en.wikipedia.org/wiki/Matrix_decomposition","data":{"page":"Matrix_decomposition","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"ylEamslQgO"},{"type":"text","value":" from linear algebra, the Singular Value Decomposition, to generate a compressed approximation of an image. We’ll use the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"V9uo6VtNU0"},{"type":"inlineCode","value":"face","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"AvEaukTmpC"},{"type":"text","value":" image from the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"JUSZF4myjQ"},{"type":"link","url":"https://docs.scipy.org/doc/scipy/reference/datasets.html","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"scipy.datasets","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"Jv3uuUD1yA"}],"urlSource":"https://docs.scipy.org/doc/scipy/reference/datasets.html","key":"aGFshMFjFB"},{"type":"text","value":" module:","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"jBe7S5KPVq"}],"key":"iXX2rPlY9D"}],"key":"CAHju2XQ5x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.datasets import face\n\nimg = face()","key":"sJPehDX2u0"},{"type":"output","id":"x6JH7XLbdtKAAIxolIeqQ","data":[{"output_type":"stream","name":"stderr","text":"Downloading file 'face.dat' from 'https://raw.githubusercontent.com/scipy/dataset-face/main/face.dat' to '/home/runner/.cache/scipy-data'.\n"}],"key":"FpSx8dNjRf"}],"key":"lutqCw6GJR"},{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"Cc3a20CNqU"}],"key":"YRVwwcxrwg"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"If you prefer, you can use your own image as you work through this tutorial.\nIn order to transform your image into a NumPy array that can be manipulated, you\ncan use the ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"nYCjgEO0KK"},{"type":"inlineCode","value":"imread","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ZXKfivOIF6"},{"type":"text","value":" function from the\n","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"qVxfUNOv1G"},{"type":"link","url":"https://matplotlib.org/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"matplotlib.pyplot","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"gssoUzYNAq"}],"urlSource":"https://matplotlib.org/api/_as_gen/matplotlib.pyplot.html#module-matplotlib.pyplot","key":"ziOs6LWqvg"},{"type":"text","value":" submodule.\nAlternatively, you can use the\n","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"w2ugyGw4qP"},{"type":"link","url":"https://imageio.readthedocs.io/en/stable/_autosummary/imageio.v3.imread.html","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"imageio.imread","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"Cs8Kqo2rxv"}],"urlSource":"https://imageio.readthedocs.io/en/stable/_autosummary/imageio.v3.imread.html","key":"jVDyQrDVCb"},{"type":"text","value":"\nfunction from the ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"uKNuCbxGiF"},{"type":"inlineCode","value":"imageio","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"OHtIt4W2Ue"},{"type":"text","value":" library.\nBe aware that if you use your own image, you’ll likely need to adapt the steps below.\nFor more information on how images are treated when converted to NumPy arrays,\nsee ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"e0rtNRU6Sc"},{"type":"link","url":"https://scikit-image.org/docs/stable/user_guide/numpy_images.html","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"A crash course on NumPy for images","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"fOsef1dVJP"}],"urlSource":"https://scikit-image.org/docs/stable/user_guide/numpy_images.html","key":"KRATQJzf6l"},{"type":"text","value":" from the ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"d1ABvH9BLM"},{"type":"inlineCode","value":"scikit-image","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"P3ELMCuiWB"},{"type":"text","value":" documentation.","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"FIqhQ62Ir6"}],"key":"TeWGv86Cer"}],"key":"ItkwxirD3b"}],"key":"L4fYIJDe6Z"},{"type":"block","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Now, ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"HaVWt1aRJD"},{"type":"inlineCode","value":"img","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"y3xLHmfWT6"},{"type":"text","value":" is a NumPy array, as we can see when using the ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"QBw3gVpKpB"},{"type":"inlineCode","value":"type","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"UkJ7z2d8Ej"},{"type":"text","value":" function:","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"s265XfkDrz"}],"key":"iujvk53apo"}],"key":"jqWUubgEVO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"type(img)","key":"NSxui1ZWVz"},{"type":"output","id":"Sx8_n_WGoxnQ9Z8cW3Qkq","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"numpy.ndarray","content_type":"text/plain"}}}],"key":"aGyskzTioT"}],"key":"vFEHY4adLD"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"We can see the image using the ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"Rj0uRlL1Ul"},{"type":"link","url":"https://matplotlib.org/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"matplotlib​.pyplot​.imshow","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"tA9NDFultI"}],"urlSource":"https://matplotlib.org/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow","key":"RvbSnnXT6p"},{"type":"text","value":" function \u0026 the special iPython command, ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"Ybp8MVbROc"},{"type":"inlineCode","value":"%matplotlib inline","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"o4KJswkzHn"},{"type":"text","value":" to display plots inline:","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"IivDyMK2Ac"}],"key":"wT27KshIEB"}],"key":"PvtVHfTk6I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n%matplotlib inline","key":"Rn8oPINbFy"},{"type":"output","id":"k5MoiHHFAld3lJeB-4sP5","data":[],"key":"bzcrVwXeVF"}],"key":"LYDuvDWJDh"},{"type":"block","children":[],"key":"p6KAlNVylH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(img)\nplt.show()","key":"Ap9NiZfos3"},{"type":"output","id":"80GOrdCSbxpX2HxdClxO3","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"35ed8e4357022ff8e82394d52fe8f523","path":"/numpy-tutorials/build/35ed8e4357022ff8e82394d52fe8f523.png"}}}],"key":"YsgBaSU4eW"}],"key":"iSEB2u9JG6"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Shape, axis and array properties","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"m1Xr6UUwJR"}],"identifier":"shape-axis-and-array-properties","label":"Shape, axis and array properties","html_id":"shape-axis-and-array-properties","implicit":true,"key":"Emp0StNV9K"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Note that, in linear algebra, the dimension of a vector refers to the number of entries in an array. In NumPy, it instead defines the number of axes. For example, a 1D array is a vector such as ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"ni0Urh3yCz"},{"type":"inlineCode","value":"[1, 2, 3]","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"eHsdKtn7ef"},{"type":"text","value":", a 2D array is a matrix, and so forth.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"U5QQwbJ0rW"}],"key":"V7bDCjqnII"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"First, let’s check for the shape of the data in our array. Since this image is two-dimensional (the pixels in the image form a rectangle), we might expect a two-dimensional array to represent it (a matrix). However, using the ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"cJR0IUcThW"},{"type":"inlineCode","value":"shape","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"IUHEwYzXfS"},{"type":"text","value":" property of this NumPy array gives us a different result:","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"PoUR3tmT5K"}],"key":"QQi3xfn03e"}],"key":"iICBQ9gWCU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img.shape","key":"iRLdxMAX4N"},{"type":"output","id":"UwQ9FjvmllX0sUSWsQTkO","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"(768, 1024, 3)","content_type":"text/plain"}}}],"key":"nAmGDiCNJL"}],"key":"RbZG3FaHHv"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"The output is a ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"wxELrlq9FH"},{"type":"link","url":"https://docs.python.org/dev/tutorial/datastructures.html#tut-tuples","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"tuple","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"Wk5PlXhax0"}],"urlSource":"https://docs.python.org/dev/tutorial/datastructures.html#tut-tuples","key":"tj8Ygw71h8"},{"type":"text","value":" with three elements, which means that this is a three-dimensional array. Since this is a color image, and we have used the ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"N5SVnbTeDf"},{"type":"inlineCode","value":"imread","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"NVJsoOeGFO"},{"type":"text","value":" function to read it, the data is organized as a 768×1024 grid of pixels, where each pixel contains 3 values representing color channels (red, green and blue - RGB). You can see this by looking at the shape, where the leftmost number corresponds to the outermost axis (image height), the middle number to the next axis (image width) and the rightmost number to the innermost axis (the color channels).","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"JtBn55TCSM"}],"key":"qTdJPQcOE8"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Furthermore, using the ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"KY02L3zbvP"},{"type":"inlineCode","value":"ndim","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"dJ1NzAALL1"},{"type":"text","value":" property of this array, we can see that","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"eJS9zZtOVs"}],"key":"uTfa0UOEB4"}],"key":"dZ8Pwd7maX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img.ndim","key":"i4OgmR53Ry"},{"type":"output","id":"FwdpYkC6vHHMk87QOcNIR","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"3","content_type":"text/plain"}}}],"key":"Z0nieRamFz"}],"key":"mQT6bSJz0Q"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"NumPy refers to each dimension as an ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"MV1TxdZ1SD"},{"type":"emphasis","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"axis","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"TZQrJh3QK6"}],"key":"uTWlgp9YYs"},{"type":"text","value":". Because of how ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"ZdO3Ln685D"},{"type":"inlineCode","value":"imread","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"NioweMOgLP"},{"type":"text","value":" works, the ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"LTW3JMqA1j"},{"type":"emphasis","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"first index in the 3rd axis","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"hH7DpmCHaL"}],"key":"jRYD2RLJx8"},{"type":"text","value":" is the red pixel data for our image. We can access this by using the syntax","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"VPvnUUjsLA"}],"key":"NkjOushiAs"}],"key":"TNZf0Mpteu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img[:, :, 0]","key":"qIhMjcXaGU"},{"type":"output","id":"2IPrHiPtWTm3iyxL2il-7","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"array([[121, 138, 153, ..., 119, 131, 139],\n       [ 89, 110, 130, ..., 118, 134, 146],\n       [ 73,  94, 115, ..., 117, 133, 144],\n       ...,\n       [ 87,  94, 107, ..., 120, 119, 119],\n       [ 85,  95, 112, ..., 121, 120, 120],\n       [ 85,  97, 111, ..., 120, 119, 118]],\n      shape=(768, 1024), dtype=uint8)","content_type":"text/plain"}}}],"key":"hPK66yoZEA"}],"key":"ykZP0P9PI1"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"From the output above, we can see that every value in ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"IA756JLsed"},{"type":"inlineCode","value":"img[:, :, 0]","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"IR1vl2CAee"},{"type":"text","value":" is an integer value between 0 and 255, representing the level of red in each corresponding image pixel (keep in mind that this might be different if you\nuse your own image instead of ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"jSJ5uXDe6l"},{"type":"link","url":"https://docs.scipy.org/doc/scipy/reference/generated/scipy.datasets.face.html","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"scipy.datasets.face","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"KwcC4paYhm"}],"urlSource":"https://docs.scipy.org/doc/scipy/reference/generated/scipy.datasets.face.html","key":"RMs7yrcVLC"},{"type":"text","value":").","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"QnYM1NZ03N"}],"key":"oze15vDiV7"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"As expected, this is a 768x1024 matrix:","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"tFX0aOYrjU"}],"key":"Ycc4MG1Ofe"}],"key":"iPUTFAIVyI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img[:, :, 0].shape","key":"X0TEu0JsoF"},{"type":"output","id":"hCiBu4zrv9C_Vmb-Wgwc7","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"(768, 1024)","content_type":"text/plain"}}}],"key":"dlfWOI6rtq"}],"key":"gQqWll31oj"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Since we are going to perform linear algebra operations on this data, it might be more interesting to have real numbers between 0 and 1 in each entry of the matrices to represent the RGB values. We can do that by setting","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"fOGgrBy8Ao"}],"key":"q3g9A7JUpZ"}],"key":"Mf58sHz15j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img_array = img / 255","key":"KxL5xUMPET"},{"type":"output","id":"AQWUWSa7xmKNRt9BwRrgz","data":[],"key":"EmCwEG0xrW"}],"key":"TM2k28VAVc"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"This operation, dividing an array by a scalar, works because of NumPy’s ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"BFl1JaeWM7"},{"type":"link","url":"https://numpy.org/devdocs/user/theory.broadcasting.html#array-broadcasting-in-numpy","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"broadcasting rules","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"G3bYO9ozrw"}],"urlSource":"https://numpy.org/devdocs/user/theory.broadcasting.html#array-broadcasting-in-numpy","key":"K1IFjYNqyd"},{"type":"text","value":".","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"MGaDuHElV2"}],"key":"Or9bTWCoQe"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"cZQbxWLCgr"}],"key":"i0hdARgiu2"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"In real-world applications, it may be better to use, for example, the\n","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"tutxUlnicW"},{"type":"link","url":"https://scikit-image.org/docs/stable/api/skimage.html#skimage.img_as_float","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"img_as_float","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"S4QT3ivFoz"}],"urlSource":"https://scikit-image.org/docs/stable/api/skimage.html#skimage.img_as_float","key":"m74sGlDLKj"},{"type":"text","value":"\nutility function from ","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"r4r1Vfrkjs"},{"type":"inlineCode","value":"scikit-image","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"M36Id3Sc6X"},{"type":"text","value":".","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"UZTXyYQy0a"}],"key":"ZQekjWLAnT"}],"key":"a5v63YCELw"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"You can check that the above works by doing some tests; for example, inquiring\nabout maximum and minimum values for this array:","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"ZEv70p22Vp"}],"key":"ez1kyAtK8S"}],"key":"m37H2zArZh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img_array.min(), img_array.max()","key":"YoxwnmxcOO"},{"type":"output","id":"YG_YFVrZHMwQ-Oy_x8inU","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(np.float64(0.0), np.float64(1.0))","content_type":"text/plain"}}}],"key":"WZ9Fdl5vyb"}],"key":"NHXQl0z4vE"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"or checking the type of data in the array:","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"hgO0G51rl7"}],"key":"kPcR9egods"}],"key":"AEQOgQg5Y7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img_array.dtype","key":"PLW3Q6aXNE"},{"type":"output","id":"xKkCpNS3slX12KHBbtFfZ","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"dtype('float64')","content_type":"text/plain"}}}],"key":"xcrJhqHQWZ"}],"key":"GLtlTln5Qc"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"Note that we can assign each color channel to a separate matrix using the slice syntax:","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"zni5UBY3hx"}],"key":"YbGeOUjrCu"}],"key":"J6YEu1vLHG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"red_array = img_array[:, :, 0]\ngreen_array = img_array[:, :, 1]\nblue_array = img_array[:, :, 2]","key":"e1OJT4tRnI"},{"type":"output","id":"CBOTGZWWO_wqD3RY6KHHg","data":[],"key":"vmU75QIMZx"}],"key":"LRWDiosjzw"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"Operations on an axis","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"y2xyz3ehbg"}],"identifier":"operations-on-an-axis","label":"Operations on an axis","html_id":"operations-on-an-axis","implicit":true,"key":"LvK1IoF5BS"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"It is possible to use methods from linear algebra to approximate an existing set of data. Here, we will use the ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"UMeHhPzb7D"},{"type":"link","url":"https://en.wikipedia.org/wiki/Singular_value_decomposition","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"SVD (Singular Value Decomposition)","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"TFYm59bXLl"}],"urlSource":"https://en.wikipedia.org/wiki/Singular_value_decomposition","data":{"page":"Singular_value_decomposition","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"I4F9ErpXva"},{"type":"text","value":" to try to rebuild an image that uses less singular value information than the original one, while still retaining some of its features.","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"GvjDATLQxA"}],"key":"KS7Y35WFvB"}],"key":"hTMDAPNaX0"},{"type":"block","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"WYbs2Uw5dw"}],"key":"HMwQ1e8IOI"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"We will use NumPy’s linear algebra module,\n","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"ImMvdeYHCG"},{"type":"link","url":"https://numpy.org/devdocs/reference/routines.linalg.html#module-numpy.linalg","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"numpy.linalg","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"XXnl5uXoSZ"}],"urlSource":"https://numpy.org/devdocs/reference/routines.linalg.html#module-numpy.linalg","key":"vgpVM46zVm"},{"type":"text","value":",\nto perform the operations in this tutorial.\nMost of the linear algebra functions in this module can also be found in\n","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"T2swbFoUTV"},{"type":"link","url":"https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"scipy.linalg","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"ZjVqf5hVXX"}],"urlSource":"https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg","key":"FjqpgBJneZ"},{"type":"text","value":",\nand users are encouraged to use the ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"NNOMUjOA8r"},{"type":"link","url":"https://docs.scipy.org/doc/scipy/reference/index.html#module-scipy","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"scipy","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"OdXeEmh6Lb"}],"urlSource":"https://docs.scipy.org/doc/scipy/reference/index.html#module-scipy","key":"JBwaEW4XmC"},{"type":"text","value":"\nmodule for real-world applications.\nHowever, some functions in the\n","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"HXcOw9dgCN"},{"type":"link","url":"https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"scipy.linalg","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"dEZmfa8ibS"}],"urlSource":"https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg","key":"DGlhPvKwTN"},{"type":"text","value":"\nmodule, such as the SVD function, only support 2D arrays.\nFor more information on this, check the ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"RmFUr7guQl"},{"type":"link","url":"https://docs.scipy.org/doc/scipy/tutorial/linalg.html","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"scipy.linalg page","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"c3mIjiRSwv"}],"urlSource":"https://docs.scipy.org/doc/scipy/tutorial/linalg.html","key":"KOVW0uPdaU"},{"type":"text","value":".","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"OdfbL4E3aT"}],"key":"YDGyJXJdPN"}],"key":"GR6XYPOGlv"}],"key":"LU2sIMiLqT"},{"type":"block","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"In order to extract information from a given matrix, we can use the SVD to obtain 3 arrays which can be multiplied to obtain the original matrix. From the theory of linear algebra, given a matrix ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"l2QKGSgcuI"},{"type":"inlineMath","value":"A","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eA\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"dUutqlOnYp"},{"type":"text","value":", the following product can be computed:","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"nYy37KJhz9"}],"key":"bzfUBc2LnZ"},{"type":"math","value":"U \\Sigma V^T = A","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eU\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003eΣ\u003c/mi\u003e\u003cmsup\u003e\u003cmi\u003eV\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eU \\Sigma V^T = A\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8913em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eU\u003c/span\u003e\u003cspan class=\"mord\"\u003eΣ\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8913em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"CASFHsxNGU"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"HkUXiDBldg"},{"type":"inlineMath","value":"U","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eU\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eU\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eU\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ptov31KSPL"},{"type":"text","value":" and ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"LtBMVcdGR8"},{"type":"inlineMath","value":"V^T","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eV\u003c/mi\u003e\u003cmi\u003eT\u003c/mi\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eV^T\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8413em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eV\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8413em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\"\u003eT\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"N800jdvCUA"},{"type":"text","value":" are square and ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"xJMapvJ5u9"},{"type":"inlineMath","value":"\\Sigma","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003eΣ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\Sigma\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΣ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"l3reEGPA4o"},{"type":"text","value":" is the same size as ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"iGtWzmVwMy"},{"type":"inlineMath","value":"A","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eA\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"SGlVVYPEjh"},{"type":"text","value":". ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"Ld1M1obqIJ"},{"type":"inlineMath","value":"\\Sigma","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003eΣ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\Sigma\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΣ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"n1DBfG3q8k"},{"type":"text","value":" is a diagonal matrix and contains the ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"vkQi7OJBYa"},{"type":"link","url":"https://en.wikipedia.org/wiki/Singular_value","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"singular values","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"t9D1Ail2BT"}],"urlSource":"https://en.wikipedia.org/wiki/Singular_value","data":{"page":"Singular_value","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"my6y01HZxo"},{"type":"text","value":" of ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"GK6v8Bsb5k"},{"type":"inlineMath","value":"A","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eA\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"fdN58j2F5X"},{"type":"text","value":", organized from largest to smallest. These values are always non-negative and can be used as an indicator of the “importance” of some features represented by the matrix ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"OIq2heCGp8"},{"type":"inlineMath","value":"A","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eA\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"MpDCWOXkHU"},{"type":"text","value":".","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"P31w9gaaxP"}],"key":"obbrkvSB6t"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"Let’s see how this works in practice with just one matrix first. Note that according to ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"NU2pydqPWs"},{"type":"link","url":"https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"colorimetry","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"fw3eoCfvKC"}],"urlSource":"https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale","data":{"page":"Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"BdCKEHS8mw"},{"type":"text","value":",\nit is possible to obtain a fairly reasonable grayscale version of our color image if we apply the formula","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"E1a69KVt9b"}],"key":"L6vi7eO4Du"},{"type":"math","value":"Y = 0.2126 R + 0.7152 G + 0.0722 B","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eY\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0.2126\u003c/mn\u003e\u003cmi\u003eR\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e0.7152\u003c/mn\u003e\u003cmi\u003eG\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e0.0722\u003c/mn\u003e\u003cmi\u003eB\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eY = 0.2126 R + 0.7152 G + 0.0722 B\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eY\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.2126\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.7152\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eG\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.0722\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05017em;\"\u003eB\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"l2YsCulrVG"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"zBB1xFUKdl"},{"type":"inlineMath","value":"Y","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eY\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eY\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\"\u003eY\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"PvmCPcURnj"},{"type":"text","value":" is the array representing the grayscale image, and ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"OKhXTf5X8H"},{"type":"inlineMath","value":"R","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eR\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eR\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\"\u003eR\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Br4SBXyNlv"},{"type":"text","value":", ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"REzwRuQ1Gu"},{"type":"inlineMath","value":"G","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eG\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eG\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eG\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"nGBSSU0AE0"},{"type":"text","value":" and ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"o13BMF6jcl"},{"type":"inlineMath","value":"B","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eB\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eB\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05017em;\"\u003eB\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"AiI0wGyAvv"},{"type":"text","value":" are the red, green and blue channel arrays we had originally. Notice we can use the ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"CYRQAnQZg9"},{"type":"inlineCode","value":"@","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"g7e7mTXkkU"},{"type":"text","value":" operator (the matrix multiplication operator for NumPy arrays, see ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"IaWsgcgfUX"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"numpy.matmul","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"LYaHQjm9Tp"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul","key":"O823OZWGui"},{"type":"text","value":") for this:","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"xVK5dqeuf2"}],"key":"cMWANENVxY"}],"key":"ODX3ygGK8T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img_gray = img_array @ [0.2126, 0.7152, 0.0722]","key":"Vat9Yq8NIr"},{"type":"output","id":"Tpp3gC7Q6HYm14nQl2p7B","data":[],"key":"DiF7LWIURJ"}],"key":"xGQ158f3kB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Now, ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"uh4gmRl5yp"},{"type":"inlineCode","value":"img_gray","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"udoXbTXOrX"},{"type":"text","value":" has shape","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"Kf39yO0xB8"}],"key":"LQtpWFajZj"}],"key":"eV7uamyHhd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img_gray.shape","key":"FFhswDtJVO"},{"type":"output","id":"Q8BeIO53hZc9HI2SURYQc","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(768, 1024)","content_type":"text/plain"}}}],"key":"XoGoMLg6vP"}],"key":"pxANcckHig"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"To see if this makes sense in our image, we should use a colormap from ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"KeV4kvYtgV"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"z6mgOrVU33"},{"type":"text","value":" corresponding to the color we wish to see in out image (otherwise, ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"drrOpN2Iaj"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"m9X8TtKaha"},{"type":"text","value":" will default to a colormap that does not correspond to the real data).","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"ROXBEPJoDk"}],"key":"Y2H9hDVQei"},{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"In our case, we are approximating the grayscale portion of the image, so we will use the colormap ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"ZlfL81JTll"},{"type":"inlineCode","value":"gray","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"pjnjZGNcu7"},{"type":"text","value":":","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"Rwb5q8ACUW"}],"key":"CV78CFwNIa"}],"key":"XmV8LrxrOr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(img_gray, cmap=\"gray\")\nplt.show()","key":"Yiage8nYcF"},{"type":"output","id":"So5aCgiJ4fYOcCKcCdogK","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"bb7f8d356776563e0184fede5531d1c4","path":"/numpy-tutorials/build/bb7f8d356776563e0184fede5531d1c4.png"}}}],"key":"FOjkPudeTM"}],"key":"beCpRLI0Eb"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Now, applying the ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"sKroJCrE71"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.linalg.svd.html#numpy.linalg.svd","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"linalg.svd","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"bjSJ9oGgVR"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.linalg.svd.html#numpy.linalg.svd","key":"RHX85JGUta"},{"type":"text","value":" function to this matrix, we obtain the following decomposition:","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"O33SGZqrhs"}],"key":"zPy5nke7nY"}],"key":"aMhzy9ZILR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nU, s, Vt = np.linalg.svd(img_gray)","key":"U09IvuHIU7"},{"type":"output","id":"6gXEYnmKkzhsSrg8YxhKo","data":[],"key":"zIkvfrjXbA"}],"key":"QzmHy4v9rT"},{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"BGRO4wnbvo"}],"key":"W5jSdjRsik"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"If you are using your own image, this command might take a while to run,\ndepending on the size of your image and your hardware.\nDon’t worry, this is normal! The SVD can be a pretty intensive computation.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"TajumBb04P"}],"key":"AZHlUJM2cv"}],"key":"A5EPdMFsNK"}],"key":"QrAkRHVxKn"},{"type":"block","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"Let’s check that this is what we expected:","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"l1Ud3fvqPM"}],"key":"qxC4GHb0pk"}],"key":"LjBgQxyJMk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U.shape, s.shape, Vt.shape","key":"pp0MI2hf5z"},{"type":"output","id":"slkSbue1WMCLvnk6_Bxwc","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"((768, 768), (768,), (1024, 1024))","content_type":"text/plain"}}}],"key":"DUUqpYf8Z3"}],"key":"fHnLt5t4vb"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Note that ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"w6FArt2E9R"},{"type":"inlineCode","value":"s","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"CEqnrv1rsK"},{"type":"text","value":" has a particular shape: it has only one dimension. This means that some linear algebra functions that expect 2d arrays might not work. For example, from the theory, one might expect ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"Bpq0vUiFvc"},{"type":"inlineCode","value":"s","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"hVxiG5I22v"},{"type":"text","value":" and ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"NMsxtAa9tf"},{"type":"inlineCode","value":"Vt","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"WzHMhkuaZJ"},{"type":"text","value":" to be\ncompatible for multiplication. However, this is not true as ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"FHVVxNDTpb"},{"type":"inlineCode","value":"s","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"T0uLQc9ANl"},{"type":"text","value":" does not have a second axis:","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"H3BaAzYy5m"}],"key":"jKISk2jysx"}],"key":"E0LHqmvgQ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s @ Vt","visibility":"show","key":"lIlwZCi4YP"},{"type":"output","id":"OG5igOswuQMYKmnHndGkr","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mValueError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[18]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----\u003e \u001b[39m\u001b[32m1\u001b[39m \u001b[43ms\u001b[49m\u001b[43m \u001b[49m\u001b[43m@\u001b[49m\u001b[43m \u001b[49m\u001b[43mVt\u001b[49m\n\n\u001b[31mValueError\u001b[39m: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)-\u003e(n?,m?) (size 1024 is different from 768)","ename":"ValueError","evalue":"matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)-\u003e(n?,m?) (size 1024 is different from 768)"}],"visibility":"show","key":"fZtf8B15Ry"}],"data":{"tags":["raises-exception"]},"visibility":"show","key":"rb2dMnhgI8"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"results in a ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"FWEyYo0VsA"},{"type":"inlineCode","value":"ValueError","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"f85EUUU8aT"},{"type":"text","value":". This happens because having a one-dimensional array for ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"wnpT0vNJhl"},{"type":"inlineCode","value":"s","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"K3OzuJSz0G"},{"type":"text","value":", in this case, is much more economic in practice than building a diagonal matrix with the same data. To reconstruct the original matrix, we can rebuild the diagonal matrix ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"OLYmOK1aIh"},{"type":"inlineMath","value":"\\Sigma","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003eΣ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\Sigma\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΣ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Vz85k6pOjQ"},{"type":"text","value":" with the elements of ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"zdHCah3l8R"},{"type":"inlineCode","value":"s","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"gGazpYXdcp"},{"type":"text","value":" in its diagonal and with the appropriate dimensions for multiplying: in our case, ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"w2hdtvJVIj"},{"type":"inlineMath","value":"\\Sigma","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003eΣ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\Sigma\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΣ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"VDBaqmpFtF"},{"type":"text","value":" should be 768x1024 since ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"PlzoaOGoSy"},{"type":"inlineCode","value":"U","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"tiDQqHXLju"},{"type":"text","value":" is 768x768 and ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"pbY0Ja4Ovf"},{"type":"inlineCode","value":"Vt","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"h0qI1YI11m"},{"type":"text","value":" is 1024x1024. In order to add the singular values to the diagonal of ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"EPBLDd78wh"},{"type":"inlineCode","value":"Sigma","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"oGqSJQuvMG"},{"type":"text","value":", we will use the ","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"zgn46Iq2IJ"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.fill_diagonal.html","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"text","value":"fill_diagonal","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"vE57X04Mxq"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.fill_diagonal.html","key":"lJQ0b5q8sR"},{"type":"text","value":" function from NumPy:","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"abvrRRKinR"}],"key":"dIq6qfJ0Il"}],"key":"iUuIppH3oq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Sigma = np.zeros((U.shape[1], Vt.shape[0]))\nnp.fill_diagonal(Sigma, s)","key":"YcW42I9Z7Q"},{"type":"output","id":"SxNsmNCjByReHPbFnO6r6","data":[],"key":"Ory9mvluTy"}],"key":"vnvkWMeeMW"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"Now, we want to check if the reconstructed ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"eqAGIavjl8"},{"type":"inlineCode","value":"U @ Sigma @ Vt","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"u5Jr11pg5X"},{"type":"text","value":" is close to the original ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"oavDtVCEQb"},{"type":"inlineCode","value":"img_gray","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"QAkCaK1Ao8"},{"type":"text","value":" matrix.","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"MkGSXGX0wa"}],"key":"TosMgRhfZq"}],"key":"WDrwdM4an1"},{"type":"block","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"Approximation","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"mR38SrVnyh"}],"identifier":"approximation","label":"Approximation","html_id":"approximation","implicit":true,"key":"HfLfdSt1ED"},{"type":"paragraph","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"hfwzg3aMTU"},{"type":"link","url":"https://numpy.org/devdocs/reference/routines.linalg.html#module-numpy.linalg","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"linalg","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"lnlHHBmmCO"}],"urlSource":"https://numpy.org/devdocs/reference/routines.linalg.html#module-numpy.linalg","key":"urzHdTWTUX"},{"type":"text","value":" module includes a ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"cGwKieAuht"},{"type":"inlineCode","value":"norm","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"kpbrgidNud"},{"type":"text","value":" function, which computes the norm of a vector or matrix represented in a NumPy array. For example, from the SVD explanation above, we would expect the norm of the difference between ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"jH3ufXg5sA"},{"type":"inlineCode","value":"img_gray","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"PJ41gM0EMJ"},{"type":"text","value":" and the reconstructed SVD product to be small. As expected, you should see something like","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"cgyibNV49w"}],"key":"kOXdoJ6twm"}],"key":"wl3cvYUxMA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.linalg.norm(img_gray - U @ Sigma @ Vt)","key":"uwcnsJjIFQ"},{"type":"output","id":"ZYB6RDgpfJPCWHDiFoITR","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"np.float64(1.4314854759568272e-12)","content_type":"text/plain"}}}],"key":"aHGIkBf8bM"}],"key":"r861AtP0Ls"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"(The actual result of this operation might be different depending on your architecture and linear algebra setup. Regardless, you should see a small number.)","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"yASUhhG1mf"}],"key":"ssBTANflkq"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"We could also have used the ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"JbUkYVP1Ct"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.allclose.html#numpy.allclose","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"numpy.allclose","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"oKO1VDxzgR"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.allclose.html#numpy.allclose","key":"gjeEG8ImAw"},{"type":"text","value":" function to make sure the reconstructed product is, in fact, ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"YKEby77gC5"},{"type":"emphasis","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"close","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"K5pRoKtDkx"}],"key":"fLGt5geNW8"},{"type":"text","value":" to our original matrix (the difference between the two arrays is small):","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"z5G0C9lwtJ"}],"key":"mtN7K9fZRC"}],"key":"kD1Gmwbl9p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np.allclose(img_gray, U @ Sigma @ Vt)","key":"JHkcuQ0cxz"},{"type":"output","id":"_Ko10rKrhIpBYYNUsn4Wd","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"DmhHiIGxoX"}],"key":"gKxejRGXZr"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"To see if an approximation is reasonable, we can check the values in ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"MFNzR7ieDX"},{"type":"inlineCode","value":"s","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"LHFnOoXgPB"},{"type":"text","value":":","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"WebAMTEbzG"}],"key":"Efrq0087Cu"}],"key":"hSF6pHqNd7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(s)\nplt.show()","key":"FVpKJQDb58"},{"type":"output","id":"OgXITMhxiTjfsi1o9OiGV","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2ff5865e000b94880260d6057f07561c","path":"/numpy-tutorials/build/2ff5865e000b94880260d6057f07561c.png"}}}],"key":"lipHOFgom1"}],"key":"BRwMyiDMln"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"In the graph, we can see that although we have 768 singular values in ","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"xBrJmCeR9a"},{"type":"inlineCode","value":"s","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"D44iC5V5kR"},{"type":"text","value":", most of those (after the 150th entry or so) are pretty small. So it might make sense to use only the information related to the first (say, 50) ","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"vovD7cIX0m"},{"type":"emphasis","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"singular values","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"Cg4cMPs1hd"}],"key":"ajqvlHZEN0"},{"type":"text","value":" to build a more economical approximation to our image.","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"RbyCT85nI9"}],"key":"L0VYsn83zW"},{"type":"paragraph","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"children":[{"type":"text","value":"The idea is to consider all but the first ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"XYmSKovjKu"},{"type":"inlineCode","value":"k","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"KCTGYWKzG5"},{"type":"text","value":" singular values in ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"W89eRnqTA2"},{"type":"inlineCode","value":"Sigma","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"aN6zCQQvnW"},{"type":"text","value":" (which are the same as in ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"R2PaAvBVm4"},{"type":"inlineCode","value":"s","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"wcbSWc2ohT"},{"type":"text","value":") as zeros, keeping ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"F3PTn4BQyU"},{"type":"inlineCode","value":"U","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"BUOq3b0Ljq"},{"type":"text","value":" and ","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"plD1boIZfB"},{"type":"inlineCode","value":"Vt","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"uM1BYdw2XK"},{"type":"text","value":" intact, and computing the product of these matrices as the approximation.","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"hOLPMfapl0"}],"key":"jp8rWiDgeG"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"For example, if we choose","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"SiowcbeYCy"}],"key":"EwyB5xHmNQ"}],"key":"KBFKeQJXWe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"k = 10","key":"eysh6OaKYq"},{"type":"output","id":"VfmwTwd6ibWx4Zei_em5j","data":[],"key":"TrC0T2b2Kl"}],"key":"MHbSMQDxyS"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"we can build the approximation by doing","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"JtueP2wosd"}],"key":"Wv7jmmN7y7"}],"key":"Zl1uPzfJpw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"approx = U @ Sigma[:, :k] @ Vt[:k, :]","key":"mPHvGEBYFj"},{"type":"output","id":"AkkRdE5Vf1CajLlxNQOEd","data":[],"key":"hdubus1qZ2"}],"key":"qwopRmfxs0"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"Note that we had to use only the first ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"ZlQpwY5OWD"},{"type":"inlineCode","value":"k","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"QI6o2POXXX"},{"type":"text","value":" rows of ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"xEeM8seM7M"},{"type":"inlineCode","value":"Vt","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"X8XTOCgXEN"},{"type":"text","value":", since all other rows would be multiplied by the zeros corresponding to the singular values we eliminated from this approximation.","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"Sg7p0AZO3i"}],"key":"BrqiiTaWbL"}],"key":"Tvtym9Xelg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(approx, cmap=\"gray\")\nplt.show()","key":"tfjdulxbDO"},{"type":"output","id":"24ujeX-mHFp47uHQPeRqM","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8518b580a53672f5f630f659c4699def","path":"/numpy-tutorials/build/8518b580a53672f5f630f659c4699def.png"}}}],"key":"zxQgXqRwyN"}],"key":"frnHS03PoM"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Now, you can go ahead and repeat this experiment with other values of ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"o1nY1BXAnJ"},{"type":"inlineCode","value":"k","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"aHKkwadx3h"},{"type":"text","value":", and each of your experiments should give you a slightly better (or worse) image depending on the value you choose.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"XCIvZvOf08"}],"key":"TixkWTSmpo"}],"key":"axbqEqD3J9"},{"type":"block","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"Applying to all colors","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"Qjqv9N4ULJ"}],"identifier":"applying-to-all-colors","label":"Applying to all colors","html_id":"applying-to-all-colors","implicit":true,"key":"BYZY2rckZe"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"Now we want to do the same kind of operation, but to all three colors. Our first instinct might be to repeat the same operation we did above to each color matrix individually. However, NumPy’s ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"zPpoDF2CgE"},{"type":"emphasis","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"broadcasting","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"EQ1oWmqOTl"}],"key":"i0rPVOSr9c"},{"type":"text","value":" takes care of this\nfor us.","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"CUTgLkBjNV"}],"key":"jFUoMUBBZ9"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"If our array has more than two dimensions, then the SVD can be applied to all axes at once. However, the linear algebra functions in NumPy expect to see an array of the form ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"SDlnwNHjM0"},{"type":"inlineCode","value":"(n, M, N)","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"yoIx6rN948"},{"type":"text","value":", where the first axis ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"JFW3RLW57f"},{"type":"inlineCode","value":"n","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"TZXuTCGUic"},{"type":"text","value":" represents the number of ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"HHO15gko8H"},{"type":"inlineCode","value":"MxN","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"Qs5K7CiDiz"},{"type":"text","value":" matrices in the stack.","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"lK6BTb3UyZ"}],"key":"V6E1dgBytk"},{"type":"paragraph","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"In our case,","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"Q0ZUlPE35o"}],"key":"ghilmiG983"}],"key":"ew6OODiDDx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img_array.shape","key":"UKGlkpw0re"},{"type":"output","id":"_acaPrD5_zAjWJrAkq7qD","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"(768, 1024, 3)","content_type":"text/plain"}}}],"key":"WFWssI5hhe"}],"key":"A87NTBr2PC"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"so we need to permutate the axis on this array to get a shape like ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"En5TgccSiv"},{"type":"inlineCode","value":"(3, 768, 1024)","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"AgceJnT3IP"},{"type":"text","value":". Fortunately, the ","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"ryNYs54vDC"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.transpose.html#numpy.transpose","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"numpy.transpose","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"VNYyowksBW"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.transpose.html#numpy.transpose","key":"PVHwDJemaI"},{"type":"text","value":" function can do that for us:","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"XHfwjO9Y9k"}],"key":"IXykAOb4IG"}],"key":"TCJfgiYlfa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# The values in the tuple indicate the original dim, and the order the new axis\n# so axis 2 -\u003e 0, 0 -\u003e 1, and 1 -\u003e 2\nimg_array_transposed = np.transpose(img_array, (2, 0, 1))\nimg_array_transposed.shape","key":"HzwAOhG5L3"},{"type":"output","id":"9YL2iIqkiKPx1P0U-NUno","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"(3, 768, 1024)","content_type":"text/plain"}}}],"key":"mLDnOWaMLY"}],"key":"Hhcrhgk7wB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"Now we are ready to apply the SVD:","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"oVS2S8XWCI"}],"key":"cRAa29jeJ5"}],"key":"Gakz0E5rLp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U, s, Vt = np.linalg.svd(img_array_transposed)","key":"zZJXlI3Dxz"},{"type":"output","id":"8GGIAcBDkrpR7-D8X35zj","data":[],"key":"pEEPWOFpyp"}],"key":"KNNcSSV48M"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"Finally, to obtain the full approximated image, we need to reassemble these matrices into the approximation. Now, note that","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"ixQ9FygFze"}],"key":"lfl3kuo70M"}],"key":"JM28D9tdDX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U.shape, s.shape, Vt.shape","key":"FbwGMTfmBL"},{"type":"output","id":"36l7JnPjWrG7m8nwuxmJq","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"((3, 768, 768), (3, 768), (3, 1024, 1024))","content_type":"text/plain"}}}],"key":"FEEjzVmzZH"}],"key":"vcIA7IryGc"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"To build the final approximation matrix, we must understand how multiplication across different axes works.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"UzghvvRHqN"}],"key":"RdQ6YLGWiG"}],"key":"Vxsny4B7hN"},{"type":"block","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"Products with n-dimensional arrays","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"iSApwjTmrV"}],"identifier":"products-with-n-dimensional-arrays","label":"Products with n-dimensional arrays","html_id":"products-with-n-dimensional-arrays","implicit":true,"key":"A98oLNkQDn"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"If you have worked before with only one- or two-dimensional arrays in NumPy, you might use ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"Z5fmyZdlLd"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.dot.html#numpy.dot","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"numpy.dot","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"QFyXYVZb55"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.dot.html#numpy.dot","key":"X5IX7u00ZF"},{"type":"text","value":" and ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"hetm0K6SbB"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"numpy.matmul","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"kFXvzQUl4U"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul","key":"MtvhfCYf4L"},{"type":"text","value":" (or the ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"NlRK302DaP"},{"type":"inlineCode","value":"@","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"XnW2PaqY6Z"},{"type":"text","value":" operator) interchangeably. However, for n-dimensional arrays, they work in very different ways. For more details, check the documentation on ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"oLMARPOcIg"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"numpy.matmul","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"KWwFWeANU8"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.matmul.html#numpy.matmul","key":"ITsnXjwaa2"},{"type":"text","value":".","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"EjXFRXzogo"}],"key":"zBN9oGx5Bt"},{"type":"paragraph","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"children":[{"type":"text","value":"Now, to build our approximation, we first need to make sure that our singular values are ready for multiplication, so we build our ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"YJZdj3DasN"},{"type":"inlineCode","value":"Sigma","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"ZZKypc5oqG"},{"type":"text","value":" matrix similarly to what we did before. The ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"CUKmWaDt7c"},{"type":"inlineCode","value":"Sigma","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"S9ooRKPVoi"},{"type":"text","value":" array must have dimensions ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"YlRtxMRAH0"},{"type":"inlineCode","value":"(3, 768, 1024)","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"iqYLwVmUSK"},{"type":"text","value":". In order to add the singular values to the diagonal of ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"v41TCUPz8G"},{"type":"inlineCode","value":"Sigma","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"RHPz7A5UAK"},{"type":"text","value":", we will again use the ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"OkVHKWLjTC"},{"type":"link","url":"https://numpy.org/devdocs/reference/generated/numpy.fill_diagonal.html","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"children":[{"type":"text","value":"fill_diagonal","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"LpkqTbNWBF"}],"urlSource":"https://numpy.org/devdocs/reference/generated/numpy.fill_diagonal.html","key":"miELarldyc"},{"type":"text","value":" function, using each of the 3 rows in ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"AsouJYuIhp"},{"type":"inlineCode","value":"s","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"OgDVB4qXCm"},{"type":"text","value":" as the diagonal for each of the 3 matrices in ","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"aygk5j7Uuh"},{"type":"inlineCode","value":"Sigma","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"DKypVqSS6W"},{"type":"text","value":":","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"EjT9lcMvRJ"}],"key":"P2hU2ErayY"}],"key":"eaeiZ2iFFc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Sigma = np.zeros((3, 768, 1024))\nfor j in range(3):\n    np.fill_diagonal(Sigma[j, :, :], s[j, :])","key":"TTFyXh0ZMP"},{"type":"output","id":"DyMFT57MTXGgnvV5OO3WC","data":[],"key":"nPlZypgeiU"}],"key":"VgUBCcOaw0"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"Now, if we wish to rebuild the full SVD (with no approximation), we can do","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"Zp7WIo5sA3"}],"key":"zQ31KwYM0Z"}],"key":"CPjg8PDUhQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"reconstructed = U @ Sigma @ Vt","key":"v1rmNOkIed"},{"type":"output","id":"LWPPtMb_yIjEMofeKvk8O","data":[],"key":"jIRC2QUh0j"}],"key":"gSMAbceKdO"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"children":[{"type":"text","value":"Note that","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"r1GJweevJF"}],"key":"WvQazcWYcv"}],"key":"qZe5ZuRvqc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"reconstructed.shape","key":"WxkKVX0wpu"},{"type":"output","id":"Tsgas1v5yECnRBknZQyZe","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"(3, 768, 1024)","content_type":"text/plain"}}}],"key":"dAeYR6Lr9Q"}],"key":"ce8q262xev"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"The reconstructed image should be indistinguishable from the original one, except for differences due to floating point errors from the reconstruction. Recall that our original image consisted of floating point values in the range ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"VwQLDQeusl"},{"type":"inlineCode","value":"[0., 1.]","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"bfwvFwPxy7"},{"type":"text","value":". The accumulation of floating point error from the reconstruction can result in values slightly outside this original range:","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"HZlZn7gvMi"}],"key":"Xev51E2SOQ"}],"key":"X3jLyQHlAI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"reconstructed.min(), reconstructed.max()","key":"UWCdIxLRoY"},{"type":"output","id":"dmSXl7BrwpYgA6cSGbF1x","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"(np.float64(-5.0176876542629145e-15), np.float64(1.0000000000000049))","content_type":"text/plain"}}}],"key":"SZAGXJ0irD"}],"key":"Hnjk4ENMnK"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"Since ","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"iLAlVwk1Cl"},{"type":"inlineCode","value":"imshow","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"WYDgmYFGCB"},{"type":"text","value":" expects values in the range, we can use ","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"we0gNqKLjQ"},{"type":"inlineCode","value":"clip","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"iuTFu1i3DW"},{"type":"text","value":" to excise the floating point error:","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"EP6T6QH3sb"}],"key":"KFjgebG2tm"}],"key":"dg03qZ9IHU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"reconstructed = np.clip(reconstructed, 0, 1)\nplt.imshow(np.transpose(reconstructed, (1, 2, 0)))\nplt.show()","key":"M7RUOpN9mL"},{"type":"output","id":"S_6wt6YWNLkmFKUUOvOlb","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3d50d6f8f5ee12a8f873781f2a366fb5","path":"/numpy-tutorials/build/3d50d6f8f5ee12a8f873781f2a366fb5.png"}}}],"key":"DRsYYaVh3D"}],"key":"puW5jTimZK"},{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"AqlzGDgWrQ"}],"key":"IVFceAasUe"},{"type":"paragraph","position":{"start":{"line":369,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"In fact, ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"ziXGILDQG5"},{"type":"inlineCode","value":"imshow","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"LdQ5036x2E"},{"type":"text","value":" peforms this clipping under-the-hood, so if you skip the first\nline in the previous code cell, you might see a warning message saying\n","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"AbFM77KyaK"},{"type":"inlineCode","value":"\"Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).\"","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"wg1dlzZlDi"}],"key":"w51R3gO5ax"}],"key":"gwUNVhUgS8"},{"type":"paragraph","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"Now, to do the approximation, we must choose only the first ","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"OpPyKNHtkK"},{"type":"inlineCode","value":"k","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"HrH9MokMsk"},{"type":"text","value":" singular values for each color channel. This can be done using the following syntax:","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"bPD71E73ZN"}],"key":"HpQt3WpzRS"}],"key":"Fh926CuKc1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"approx_img = U @ Sigma[..., :k] @ Vt[..., :k, :]","key":"OzA90vvUfP"},{"type":"output","id":"Xb1vcESfBHEWWTQ8LOxWH","data":[],"key":"qzVOifmyNA"}],"key":"XEzPXujL3N"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":381,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"text","value":"You can see that we have selected only the first ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"ZSVSp0Pn6d"},{"type":"inlineCode","value":"k","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"V3XqSWF4ik"},{"type":"text","value":" components of the last axis for ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"V84L3Te3s6"},{"type":"inlineCode","value":"Sigma","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"BAZkJ7LHC5"},{"type":"text","value":" (this means that we have used only the first ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"qWBpELNCDk"},{"type":"inlineCode","value":"k","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"qz8NXHFL3T"},{"type":"text","value":" columns of each of the three matrices in the stack), and that we have selected only the first ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"qkcJtfqPDw"},{"type":"inlineCode","value":"k","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"TIoZ9UM05P"},{"type":"text","value":" components in the second-to-last axis of ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"UhdiKNihTw"},{"type":"inlineCode","value":"Vt","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"s5GCZuadUj"},{"type":"text","value":" (this means we have selected only the first ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"rlM5qWDmUJ"},{"type":"inlineCode","value":"k","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"dARge4TkA9"},{"type":"text","value":" rows from every matrix in the stack ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"ciSG8yx9OU"},{"type":"inlineCode","value":"Vt","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"Q93iQyt24D"},{"type":"text","value":" and all columns). If you are unfamiliar with the ellipsis syntax, it is a\nplaceholder for other axes. For more details, see the documentation on ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"l39gITMdyP"},{"type":"link","url":"https://numpy.org/devdocs/user/basics.indexing.html#basics-indexing","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"text","value":"Indexing","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"wvfTeHAQJ0"}],"urlSource":"https://numpy.org/devdocs/user/basics.indexing.html#basics-indexing","key":"Hr1Ocej6O0"},{"type":"text","value":".","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"MhIeb1B7U7"}],"key":"oa2Z3DP1qO"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"Now,","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"anaeP5aivK"}],"key":"btbmiAfttA"}],"key":"G0bA0GEuuw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"approx_img.shape","key":"IZRxAogYrB"},{"type":"output","id":"tYFf4JpOebvuwprMr6tDD","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"(3, 768, 1024)","content_type":"text/plain"}}}],"key":"Z5yQBOo9y0"}],"key":"P9cWWJVvAr"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"which is not the right shape for showing the image. Finally, reordering the axes back to our original shape of ","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"Da3LutUI8m"},{"type":"inlineCode","value":"(768, 1024, 3)","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"x2qJjec8Ac"},{"type":"text","value":", we can see our approximation:","position":{"start":{"line":390,"column":1},"end":{"line":390,"column":1}},"key":"r00eT11al1"}],"key":"vbcJrLdP5G"}],"key":"PiBgpCi5dq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(np.transpose(np.clip(approx_img, 0, 1), (1, 2, 0)))\nplt.show()","key":"BNBXeZ6PMT"},{"type":"output","id":"r1ULw-5kCbVI-4WlJYtMm","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e2fc93d528ff090a57b885dd9c221f93","path":"/numpy-tutorials/build/e2fc93d528ff090a57b885dd9c221f93.png"}}}],"key":"RSdHDCt8Sd"}],"key":"kHg2G6Tmk3"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"text","value":"Even though the image is not as sharp, using a small number of ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"VRQk7MtNtE"},{"type":"inlineCode","value":"k","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"ACdQagLIkM"},{"type":"text","value":" singular values (compared to the original set of 768 values), we can recover many of the distinguishing features from this image.","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"IuNIZZySLn"}],"key":"lh4lSe2Sal"}],"key":"qbzwWMEjrs"},{"type":"block","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Final words","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"Tl92TNY8Tn"}],"identifier":"final-words","label":"Final words","html_id":"final-words","implicit":true,"key":"DkFTOzE2JN"},{"type":"paragraph","position":{"start":{"line":403,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"text","value":"Of course, this is not the best method to ","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"P3QBlShCQ5"},{"type":"emphasis","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"approximate","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"pIdz0Ny46C"}],"key":"dPA3M4YtF7"},{"type":"text","value":" an image. However, there is, in fact, a result in linear algebra that says that the approximation we built above is the best we can get to the original matrix in\nterms of the norm of the difference. For more information, see ","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"lFHb8fyTJ8"},{"type":"emphasis","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"G. H. Golub and C. F. Van Loan, Matrix Computations, Baltimore, MD, Johns Hopkins University Press, 1985","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"Avh5Jtmfpu"}],"key":"IRjxzray3V"},{"type":"text","value":".","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"QXvHOJFYKe"}],"key":"m18ogf5yQb"},{"type":"heading","depth":2,"position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"text","value":"Further reading","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"U5DVf7zo7Z"}],"identifier":"further-reading","label":"Further reading","html_id":"further-reading","implicit":true,"key":"yArXSNs20N"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":408,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://docs.python.org/dev/tutorial/index.html","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"text","value":"Python tutorial","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"key":"zPU6ThEITH"}],"urlSource":"https://docs.python.org/dev/tutorial/index.html","key":"Jw3xKpKSo7"}],"key":"kRd7Ui5mtc"}],"key":"PDJSkNudfz"},{"type":"listItem","spread":true,"position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://numpy.org/devdocs/reference/index.html#reference","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"NumPy Reference","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"zmHnF9Uqd4"}],"urlSource":"https://numpy.org/devdocs/reference/index.html#reference","key":"jUuKZgrI70"}],"key":"SCUNUaDkRp"}],"key":"LMOaRiwn2d"},{"type":"listItem","spread":true,"position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://docs.scipy.org/doc/scipy/tutorial/index.html","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"text","value":"SciPy Tutorial","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"HmOCvG4oaE"}],"urlSource":"https://docs.scipy.org/doc/scipy/tutorial/index.html","key":"TWWYsBZTkQ"}],"key":"ZCm7X9o8I3"}],"key":"wO7F1qSHY9"},{"type":"listItem","spread":true,"position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://scipy-lectures.org","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"SciPy Lecture Notes","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"uUCyF9nSYh"}],"urlSource":"https://scipy-lectures.org","key":"sFmpmQmRzU"}],"key":"PPwaqAMOJu"}],"key":"HOYWeyJMgM"},{"type":"listItem","spread":true,"position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"http://mathesaurus.sf.net/","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"A matlab, R, IDL, NumPy/SciPy dictionary","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"O0p1014hgU"}],"urlSource":"http://mathesaurus.sf.net/","key":"hGVmNdxzcs"}],"key":"bfCkss6Rbt"}],"key":"KMRqbPBhkc"}],"key":"euruv69zR5"}],"key":"F9XdvfGw48"}],"key":"F809Egxix3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Analyzing the impact of the lockdown on air quality in Delhi, India","url":"/tutorial-air-quality-analysis","group":"Applications"},"next":{"title":"Saving and sharing your NumPy arrays","url":"/save-load-arrays","group":"Features"}}},"domain":"http://localhost:3000"},"project":{"title":"Numpy Tutorials","authors":[{"id":"Numpy Community","name":"Numpy Community"}],"github":"https://github.com/numpy/numpy-tutorials","toc":[{"file":"site/index.md"},{"children":[{"file":"content/mooreslaw-tutorial.md"},{"file":"content/tutorial-deep-learning-on-mnist.md"},{"file":"content/tutorial-x-ray-image-processing.md"},{"file":"content/tutorial-static_equilibrium.md"},{"file":"content/tutorial-plotting-fractals.md"},{"file":"content/tutorial-air-quality-analysis.md"}],"title":"Applications"},{"children":[{"file":"content/tutorial-svd.md"},{"file":"content/save-load-arrays.md"},{"file":"content/tutorial-ma.md"}],"title":"Features"},{"children":[{"file":"content/tutorial-style-guide.md"}],"file":"site/contributing.md","title":"Contributing"}],"thumbnail":"/numpy-tutorials/build/b77199e99a54e59b2e3c037c2cc90f21.svg","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Applications"},{"slug":"mooreslaw-tutorial","title":"Determining Moore’s Law with real data in NumPy","description":"","date":"","thumbnail":"/numpy-tutorials/build/01-mooreslaw-tutoria-9bfda9e6dca3effd65700df595b785c5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-deep-learning-on-mnist","title":"Deep learning on MNIST","description":"","date":"","thumbnail":"/numpy-tutorials/build/tutorial-deep-learni-afc13531aca16179e3652bf460cb0f94.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-x-ray-image-processing","title":"X-ray image processing","description":"","date":"","thumbnail":"/numpy-tutorials/build/tutorial-x-ray-image-9dac6a71ace45b637ba56b7686ee7b7b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-static-equilibrium","title":"Determining Static Equilibrium in NumPy","description":"","date":"","thumbnail":"/numpy-tutorials/build/static_eqbm-fig01-03b7d98bea6ff02c849affb0ef937eb9.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-plotting-fractals","title":"Plotting Fractals","description":"","date":"","thumbnail":"/numpy-tutorials/build/fractal-4bfe938619caff2d85fe8e7e8c96174b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-air-quality-analysis","title":"Analyzing the impact of the lockdown on air quality in Delhi, India","description":"","date":"","thumbnail":"/numpy-tutorials/build/11-delhi-aqi-2107c47621d490d75baf4bee4a76bbb6.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Features"},{"slug":"tutorial-svd","title":"Linear algebra on n-dimensional arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"save-load-arrays","title":"Saving and sharing your NumPy arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tutorial-ma","title":"Masked Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing","title":"Contributing","description":"","date":"","thumbnail":"/numpy-tutorials/build/01-fork-b2fc3c9415f52b70becf7754010721d9.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tutorial-style-guide","title":"Learn to write a NumPy tutorial","description":"","date":"","thumbnail":"/numpy-tutorials/build/56554e3d11983df8f484e8d7b2c2bdae.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/numpy-tutorials/build/manifest-3481E987.js";
import * as route0 from "/numpy-tutorials/build/root-7TUVC4ZT.js";
import * as route1 from "/numpy-tutorials/build/routes/$-P6PGXPYX.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/numpy-tutorials/build/entry.client-UNPC4GT3.js");</script></body></html>